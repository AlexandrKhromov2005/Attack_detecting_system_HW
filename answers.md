# Ответы на вопросы по анализу сетевого трафика

## 1. Каков IP-адрес зараженного узла?

**Ответ:** `192.168.204.137`

---

## 2. Каков MAC-адрес зараженного узла?

**Ответ:** `00:0c:29:9d:b8:6d`

---

## 3. Каково доменное имя зараженного узла?

**Ответ:** `38NTRGDFQKR-PC`
---

## 4. Какие сайты посетил пользователь зараженного устройства по своему желанию?

**Ответ:**

1. `www.google.de` — поисковая система Google (немецкая версия)
2. `www.excelforum.com` — форум по Microsoft Excel (переход через Google)

Пользователь сознательно выполнил поиск в Google и перешел на форум Excel. Все остальные сайты были посещены автоматически в результате вредоносных перенаправлений.

---

## 5. Посещение каких сайтов зафиксировано в сетевом трафике?

**Ответ:**

**Легитимные домены:**
- `www.google.de` — поисковая система
- `www.excelforum.com` — форум Excel (скомпрометирован)
- `www.google.com` — поисковая система Google
- `time.windows.com` — сервер синхронизации времени Windows
- `code.jquery.com` — CDN библиотеки jQuery
- `pagead2.googlesyndication.com` — рекламная сеть Google
- `www.gstatic.com` — CDN Google
- `googleads.g.doubleclick.net` — рекламная платформа Google
- `www.google-analytics.com` — система аналитики Google
- `cdn-static.formisimo.com` — аналитика форм
- `tracking.formisimo.com` — система трекинга

**Вредоносные домены:**
- `magggnitia.com` — gate-сервер для фильтрации трафика
- `digiwebname.in` — exploit kit

**Системные запросы:**
- `isatap.localdomain` — ISATAP туннель
- `wpad.localdomain` — Web Proxy Auto-Discovery

**Прямое подключение к IP:**
- `209.239.112.229` — C2-сервер (Command and Control)

---

## 6. Каково доменное имя сайта, с которого произошла загрузка вредоносного программного обеспечения?

**Ответ:** `digiwebname.in`

Этот домен является exploit kit (набор эксплойтов), который загрузил обфусцированные JavaScript-файлы для эксплуатации уязвимостей браузера и последующей доставки вредоносного payload.

---

## 7. Каков IP-адрес узла, с которого произошла загрузка вредоносного программного обеспечения?

**Ответ:** `205.234.186.111`

Этот IP-адрес соответствует домену `digiwebname.in`, с которого были загружены вредоносные JavaScript-файлы.

---

## 8. Загружались ли пользователем или системой без ведома пользователя файлы, не являющиеся вредоносными?

**Ответ:** Да, загружались.

**Легитимные файлы, загруженные автоматически:**

1. **JavaScript-библиотеки:**
   - `jquery.min.js` — библиотека jQuery (с code.jquery.com)
   - `zero-clipboard.js` — библиотека для работы с буфером обмена
   - `vbulletin_read_marker.js` — скрипт форума vBulletin
   - Скрипты Google Analytics
   - Скрипты рекламной сети Google

2. **CSS-файлы:**
   - Таблицы стилей сайтов

3. **Изображения:**
   - `favicon.ico` — иконки сайтов
   - PNG, GIF изображения
   - Рекламные баннеры

4. **Аналитические скрипты:**
   - Formisimo tracking скрипты
   - Google Analytics

Все эти файлы загружались автоматически браузером при посещении сайтов без явного действия пользователя.

---

## 9. Какие сайты (доменные имена) задействованы в заражении пользователя вредоносным программным обеспечением?

**Ответ:**

1. **`www.excelforum.com`** (69.167.155.134)
   - Роль: Скомпрометированный легитимный сайт (Traffic Distribution System)
   - Содержит вредоносный iframe или JavaScript-код
   - Является точкой входа для атаки

2. **`magggnitia.com`** (94.242.216.69)
   - Роль: Gate-сервер / фильтр трафика
   - Проверяет User-Agent, GeoIP, другие параметры
   - Перенаправляет подходящих жертв на exploit kit

3. **`digiwebname.in`** (205.234.186.111)
   - Роль: Exploit Kit (набор эксплойтов)
   - Сканирует уязвимости браузера и плагинов
   - Загружает обфусцированные JavaScript-файлы
   - Эксплуатирует уязвимости IE8/Flash/Java
   - Доставляет вредоносный payload

4. **`209.239.112.229`** (прямой IP-адрес)
   - Роль: C2-сервер (Command and Control)
   - Принимает POST-запросы от зараженной системы
   - Получает информацию о скомпрометированном хосте

---

## 10. Как именно осуществлены переходы (перенаправления) пользователя с посещенных сайтов на сайт, с которого было загружено вредоносное программное обеспечение?

**Ответ:**

### Цепочка перенаправлений:

```
www.excelforum.com → magggnitia.com → digiwebname.in
```

### Технические механизмы перенаправлений:

**1. Переход: excelforum.com → magggnitia.com**

Механизм:
- Вредоносный JavaScript-код или скрытый iframe на странице excelforum.com
- Возможно использование `document.location` или `window.location.href`
- Альтернативно: HTTP 302 Redirect на уровне сервера

Подтверждение:
- HTTP Referer в запросе к magggnitia.com: `http://www.excelforum.com/`
- URL содержит GET-параметры: `?Q2WP=p4VpeSdhe5ba&nw3=9n6MZfU9I_1Ydl8y&...`

**2. Переход: magggnitia.com → digiwebname.in**

Механизм:
- HTTP 302 Found (временное перенаправление) или
- JavaScript redirect: `window.location = "http://digiwebname.in/..."`
- Фильтрация трафика на magggnitia.com (проверка User-Agent, IP, других параметров)

Подтверждение:
- Множественные запросы к digiwebname.in с Referer: `http://www.excelforum.com/`
- Обфусцированные URL-пути на digiwebname.in

**3. Загрузка exploit kit с digiwebname.in**

Механизм:
- Автоматическая загрузка JavaScript-файлов через теги `<script>`
- Использование AJAX-запросов для загрузки дополнительных модулей
- Drive-by download (загрузка без взаимодействия пользователя)

Характеристики:
- Множественные GET-запросы к обфусцированным URL
- Файлы с именем `f.txt`, но Content-Type: `text/javascript`
- Exploit kit анализирует версии браузера/плагинов и подбирает эксплойт

**4. Коммуникация с C2-сервером**

Механизм:
- POST-запрос напрямую на IP-адрес 209.239.112.229
- Передача собранной информации о системе
- Получение команд или дополнительного payload

### Используемые техники:

- **HTTP 302 Redirect** — перенаправление на уровне протокола
- **JavaScript redirect** — перенаправление через `document.location`
- **HTML meta refresh** — `<meta http-equiv="refresh">`
- **Скрытый iframe** — невидимый iframe с вредоносным контентом
- **Obfuscated URLs** — обфусцированные пути для обхода детектирования
- **Drive-by download** — автоматическая загрузка без действий пользователя
